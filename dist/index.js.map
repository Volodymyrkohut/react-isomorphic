{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./src/server/index.js","webpack:///./src/server/middleware/html.js","webpack:///./src/server/middleware/render.js","webpack:///./src/server/middleware/store.js","webpack:///./src/shared/App.js","webpack:///./src/shared/store/actionTypes.js","webpack:///./src/shared/store/actions/init.js","webpack:///./src/shared/store/reducers/index.js","webpack:///./src/shared/store/reducers/init.js","webpack:///external \"@babel/polyfill\"","webpack:///external \"escape-string-regexp\"","webpack:///external \"express\"","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///external \"react\"","webpack:///external \"react-dom/server\"","webpack:///external \"react-redux\"","webpack:///external \"react-router-dom\"","webpack:///external \"redux\"","webpack:///external \"redux-thunk\"","webpack:///external \"serialize-javascript\""],"names":["express","use","req","res","app","handle","listen","process","env","PORT","console","log","path","resolve","__dirname","htmlMiddleware","storeMiddleware","renderMiddleware","next","publicPath","join","fs","readFile","err","html","status","send","url","store","routerContext","data","dispatch","actionInitData","htmlContent","ReactDOMServer","renderToString","htmlReplacements","HTML_CONTENT","PRELOADED_STATE","serialize","getState","isJSON","Object","keys","forEach","key","value","replace","RegExp","escapeStringRegexp","header","redirect","configureStore","createStore","reducer","compose","applyMiddleware","thunk","About","Index","Occupation","App","init","actionGetInitialData","useEffect","mapStateToProps","mapDispatchToProps","connect","INIT_DATA","type","combineReducers","initialState","state","action"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import express from 'express';\nimport app from \"./server\";\n\nexpress()\n    .use((req, res) => app.handle(req, res))\n    .listen(process.env.PORT || 8080, () => {\n        console.log(\n            `React-isomorphic App is running`\n        );\n    });","import path from 'path';\nimport express from 'express';\nimport htmlMiddleware from './middleware/html';\nimport storeMiddleware from './middleware/store';\nimport renderMiddleware from './middleware/render';\nconst app = express();\n\napp.use(\"/public\", express.static(path.resolve(__dirname, 'public')));\napp.use(htmlMiddleware());\napp.use(storeMiddleware()); // must come before render middleware\napp.use(renderMiddleware());\n\nexport default app;\n","import fs from 'fs';\nimport path from 'path';\n\nconst htmlMiddleware = () => (req, res, next) => {\n    const publicPath = path.join(__dirname, '/public');\n\n    fs.readFile(`${publicPath}/index.html`, 'utf8', (err, html) => {\n        if (!err) {\n            req.html = html;\n            next();\n        } else {\n            res.status(500).send('Error parsing index.html');\n        }\n    });\n};\n\nexport default htmlMiddleware;","import escapeStringRegexp from 'escape-string-regexp';\nimport React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport App from '../../shared/App.js';\nimport {StaticRouter} from 'react-router-dom';\nimport {Provider as ReduxProvider} from 'react-redux';\nimport serialize from 'serialize-javascript';\nimport {actionInitData} from \"../../shared/store/actions/init\";\n\nconst renderMiddleware = () => (req, res) => {\n    const {url, store} = req;\n    let html = req.html;\n\n    const routerContext = {};\n    const data = \"server\";\n\n    store.dispatch(actionInitData(\"Server\"));\n\n\n    const htmlContent = ReactDOMServer.renderToString(\n        <ReduxProvider store={store}>\n            <StaticRouter location={url} context={routerContext}>\n                <App data={data}/>\n            </StaticRouter>\n        </ReduxProvider>);\n\n    const htmlReplacements = {\n        HTML_CONTENT: htmlContent,\n        PRELOADED_STATE: serialize(store.getState(), {isJSON: true}),\n    };\n\n    Object.keys(htmlReplacements).forEach(key => {\n        const value = htmlReplacements[key];\n        html = html.replace(new RegExp('__' + escapeStringRegexp(key) + '__', 'g'), value);\n    });\n\n    if (routerContext.url) {\n        res.header('Cache-Control', 'no-cache, no-store, must-revalidate');\n        res.header('Pragma', 'no-cache');\n        res.header('Expires', 0);\n        res.redirect(302, routerContext.url);\n    } else {\n        res.send(html);\n    }\n};\n\nexport default renderMiddleware;\n","import {createStore, applyMiddleware, compose} from 'redux';\nimport reducer from '../../shared/store/reducers/index.js';\nimport thunk from \"redux-thunk\";\n\nconst configureStore = () => {\n    return createStore(reducer,\n        compose(applyMiddleware(thunk)));\n};\n\nconst storeMiddleware = () => (req, res, next) => {\n    req.store = configureStore();\n    next();\n};\n\nexport default storeMiddleware;","import React, {useEffect} from \"react\";\nimport {NavLink, Switch, Route, withRouter, Redirect} from \"react-router-dom\";\nimport {connect} from \"react-redux\";\nimport {actionInitData} from \"./store/actions/init\";\n\n\nconst About = () => <div>about page</div>;\nconst Index = () => <div>index page</div>;\nconst Occupation = () => <div>occupation page</div>;\n\nconst App = ({data, init, actionGetInitialData}) => {\n    useEffect(() => {\n        actionGetInitialData(\"Client\")\n    }, []);\n\n    return <div>\n        Data: {data} <br/>\n        Redux data: {init.data} <br/>\n        <nav>\n            <ul>\n                <li><NavLink exact to=\"/\">Main</NavLink></li>\n                <li><NavLink to=\"/about\">About</NavLink></li>\n                <li><NavLink to=\"/occupation\">Occupation</NavLink></li>\n            </ul>\n        </nav>\n        <Switch>\n            <Route path=\"/\" component={Index} exact={true}/>\n            <Route path=\"/about\" component={About} exact={true}/>\n            <Route path=\"/occupation\" component={Occupation} exact={true}/>\n        </Switch>\n    </div>\n};\n\nconst mapStateToProps = ({init}) => {\n    return {\n        init\n    }\n};\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        actionGetInitialData: (data) => {\n            dispatch(actionInitData(data))\n        }\n    }\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App)","export const INIT_DATA = \"INIT_DATA\";","import {INIT_DATA} from \"../actionTypes\";\n\nexport const actionInitData = (data) => dispatch => {\n    dispatch({type: INIT_DATA, data});\n};","import {combineReducers} from 'redux';\nimport init from \"./init\";\n\nexport default combineReducers({\n    init,\n})\n","import {INIT_DATA} from \"../actionTypes\";\n\nconst initialState = {};\n\nconst init = (state = initialState, action) => {\n    const {data} = action;\n    switch (action.type) {\n        case  INIT_DATA:\n            return {...state, data};\n        default:\n            return state;\n    }\n};\n\nexport default init;","module.exports = require(\"@babel/polyfill\");","module.exports = require(\"escape-string-regexp\");","module.exports = require(\"express\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","module.exports = require(\"react\");","module.exports = require(\"react-dom/server\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-router-dom\");","module.exports = require(\"redux\");","module.exports = require(\"redux-thunk\");","module.exports = require(\"serialize-javascript\");"],"sourceRoot":""}